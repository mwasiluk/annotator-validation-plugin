Annotator.Plugin.Validation=function(t,i){Annotator.Plugin.apply(this,arguments)},jQuery.extend(Annotator.Plugin.Validation.prototype,new Annotator.Plugin,{events:{},options:{minLength:2,maxLength:1e3,customValidators:[],messages:{minLength:"Annotation should have at least {} characters",maxLength:"Please enter no more than {} characters"},validationMsgStyle:"color: #E00000; padding: 5px;",validationMsgClass:"annotation-validation-message"},pluginInit:function(){if(Annotator.supported()){var t=this;this.validationField=null,this.validationFieldHtml=null,this.initValidationFieldHtml(),this.annotator.editor.submit=function(i){var a=this;i&&i.preventDefault();var n=jQuery.extend(!0,{},a.annotation);this.fields.forEach(function(t){t.submit(t.element,n)});var s=t.checkValidity(n);return s.valid?(this.fields.forEach(function(t){t.submit(t.element,a.annotation)}),this.publish("save",[this.annotation]),void this.hide()):void t.showValidationMessage(s.message)},this.annotator.editor.addField({load:function(i,a){$(i).hide(),$(i).html(t.validationFieldHtml),t.validationField=i}})}},showValidationMessage:function(t){t&&($(this.validationField).find("."+this.options.validationMsgClass).html(t),$(this.validationField).show())},getValidationMessage:function(t){var i=this,a=i.options.messages[t];if(a){var n=i.options[t];a=a.replace("{}",n)}return a},checkValidity:function(t){var i=this,a={valid:!0,message:null};if(this.options.minLength&&(!t.text||t.text.length<this.options.minLength))return{valid:!1,message:i.getValidationMessage("minLength")};if(this.options.maxLength&&t.text&&t.text.length>this.options.maxLength)return{valid:!1,message:i.getValidationMessage("maxLength")};if(this.options.customValidators&&this.options.customValidators.length)for(var n=0;n<this.options.customValidators.length;n++){var s=this.options.customValidators[n];if(!s.validator(t))return{valid:!1,message:s.message}}return a},initValidationFieldHtml:function(){var t=this,i="";this.options.validationMsgStyle&&(i=t.options.validationMsgStyle);var a="";this.options.validationMsgClass&&(a=t.options.validationMsgClass),this.validationFieldHtml='<div class="'+a+'" style="'+i+'"></div>'}});